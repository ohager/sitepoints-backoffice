<link rel="import" href="../../../bower_components/paper-material/paper-material.html">
<link rel="import" href="../../../bower_components/paper-card/paper-card.html">
<link rel="import" href="../../../bower_components/paper-item/paper-icon-item.html">
<link rel="import" href="../../../bower_components/paper-input/paper-input.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../../bower_components/iron-fit-behavior/iron-fit-behavior.html">


<dom-module id="account-item">
    <style>
        :host {
            display: block;
        }

        .avatar {
            display: inline-block;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            overflow: hidden;
            background-color: var(--account-item-avatar-color);
        }

        .avatar-content {
            padding-top: 8px;
            padding-left: 15px;
            font-weight: 600;
            color: white;
        }

        small{
            color: grey;
        }

        .done{
            color : blue;
        }


    </style>
    <template>
        <paper-icon-item>
            <div class="avatar" item-icon>
                <div class="avatar-content">{{_avatarChar}}</div>
            </div>
            <paper-item-body two-line class="flex">
                <div id="label" hidden$=[[_editorOpen]]>
                    <div>{{value}}</div>
                    <small secondary>{{label}}</small>
                </div>

                <paper-input type="text" value={{value}} label="Last Name" hidden$=[[!_editorOpen]]></paper-input>

            </paper-item-body>
            <paper-icon-button id="editButton" icon="create" on-click="edit" hidden></paper-icon-button>
            <paper-icon-button id="saveButton" icon="done" class="done" on-click="save" hidden></paper-icon-button>

        </paper-icon-item>
    </template>

    <script>
        (function () {

            "use strict";
            Polymer({
                is: 'account-item',


                properties: {
                    _editorOpen : {
                        type : Boolean,
                        value : false
                    },
                    _avatarChar : String,
                    label : String,
                    value : {
                        type : String,
                        notify : true,
                        observer : '_valueChanged'
                    },
                    editable : {
                        type : Boolean,
                        value : false
                    },


                },

                // TODO: Refactor this part
                save : function(event){
                    this._editorOpen = false;
                    this.$.editButton.removeAttribute('hidden');
                    this.$.saveButton.setAttribute('hidden', null);
                },

                edit : function(event){
                    this._editorOpen = true;
                    this.$.editButton.setAttribute('hidden', null);
                    this.$.saveButton.removeAttribute('hidden');
                },


                attached : function(){
                    this._avatarChar = this.label[0].toUpperCase();
                    if(this.editable){
                        this.$.editButton.removeAttribute('hidden');
                        this.$.saveButton.setAttribute('hidden', null);
                    }
                },

                _valueChanged : function(){
                    if(this.value.length){
                        this._avatarChar = this.value[0].toUpperCase();
                    }
                }

            });
        })();
    </script>

</dom-module>

